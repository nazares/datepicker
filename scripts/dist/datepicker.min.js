function t(a){return 0==a%100?0==a%400:0==a%4}Date.prototype.getISODay=function(){return(this.getDay()+6)%7+1},Date.prototype.dayOfYear=function(){let a=new Date(this);return a.setMonth(0,0),Math.round((this-a)/864e5)},Date.prototype.nth=function(){return["st","nd","rd"][((this.getDate()+90)%100-10)%10-1]||"th"},Date.prototype.weekNumber=function(){let a=new Date(this.valueOf()),b=(this.getDay()+6)%7;a.setDate(a.getDate()-b+3);let c=a.valueOf();return a.setMonth(0,1),4!==a.getDay()&&a.setMonth(0,1+(4-a.getDay()+7)%7),1+Math.ceil((c-a)/6048e5)},Date.prototype.dayOfYear=function(){let a=new Date(this);return a.setMonth(0,0),Math.round((this-a)/864e5)},Date.prototype.isLeap=function(a){return 0==a%100?0==a%400:0==a%4},Date.prototype.daysInMonth=function(){let a=new Date(this),b=(new Date(this).getFullYear(),[31,28,31,30,31,30,31,31,30,31,30,31][a.getMonth()]);return 2===a.getMonth()+1&&(b+=t(new Date().getFullYear())?1:0),b};class e{constructor(a=null,b="default"){a=a??new Date,this.Date=a,this.date=a.getDate(),this.day=a.toLocaleString(b,{weekday:"long"}),this.dayNumber=a.getDay()+1,this.dayShort=a.toLocaleString(b,{weekday:"short"}),this.year=a.getFullYear(),this.yearShort=a.toLocaleString(b,{year:"2-digit"}),this.month=a.toLocaleString(b,{month:"long"}),this.monthShort=a.toLocaleString(b,{month:"short"}),this.monthNumber=a.getMonth()+1,this.timestamp=a.getTime(),this.weekNumber=a.weekNumber(),this.ISODay=a.getISODay(),this.suffix=a.nth(),this.dOY=a.dayOfYear(),this.leap=a.isLeap(this.year),this.dIM=a.daysInMonth()}get isToday(){return this.isEqualTo(new Date)}isEqualTo(a){return(a=a instanceof e?a.Date:a).getDate()===this.date&&a.getMonth()===this.monthNumber-1&&a.getFullYear()===this.year}format(a){return a.replace(/\bd\b/,this.date.toString().padStart(2,0)).replace(/\bD\b/,this.dayShort).replace(/\bj\b/,this.date).replace(/\bl\b/,this.day).replace(/\bN\b/,this.ISODay).replace(/\bS\b/,this.suffix).replace(/\bjS\b/,this.date.toString().padStart(2,"\xA0")+this.suffix).replace(/\bw\b/,this.dayNumber-1).replace(/\bz\b/,this.dOY-1).replace(/\bW\b/,this.weekNumber).replace(/\bF\b/,this.month).replace(/\bm\b/,this.monthNumber.toString().padStart(2,"0")).replace(/\bM\b/,this.monthShort).replace(/\bn\b/,this.monthNumber).replace(/\bt\b/,this.dIM).replace(/\bL\b/,this.leap).replace(/\bY\b/,this.year).replace(/\by\b/,this.yearShort)}}class n{constructor(b=null,c="default"){const a=new e(b,c);this.lang=c,this.name=a.month,this.number=a.monthNumber,this.year=a.year,this.numberOfDays=[31,28,31,30,31,30,31,31,30,31,30,31][this.number-1],2===this.number&&(this.numberOfDays+=t(a.year)?1:0),this[Symbol.iterator]=function*(){let a=1;for(yield this.getDay(a);a<this.numberOfDays;)++a,yield this.getDay(a)}}getDay(a){return new e(new Date(this.year,this.number-1,a),this.lang)}}class a{constructor(b=null,c=null,a="default"){this.weekDays=Array.from({length:7}),this.today=new e(null,a),this.year=b??this.today.year,this.month=new n(new Date(this.year,(c||this.today.monthNumber)-1),a),this.lang=a,this[Symbol.iterator]=function*(){let a=1;for(yield this.getMonth(a);12>a;)++a,yield this.getMonth(a)},this.weekDays.forEach((a,b)=>{const c=this.month.getDay(b+1);this.weekDays.includes(c.day)||(this.weekDays[c.dayNumber-1]=c.day)})}get isLeapYear(){return t(this.year)}getMonth(a){return new n(new Date(this.year,a-1),this.lang)}getPreviousMonth(){return 1===this.month.number?new n(new Date(this.year-1,11),this.lang):new n(new Date(this.year,this.month.number-2),this.lang)}getNextMonth(){return 12===this.month.number?new n(new Date(this.year+1,0),this.lang):new n(new Date(this.year,this.month.number+2),this.lang)}goToDate(a,b){this.month=new n(new Date(this.year,a-1),this.lang),this.year=b}goToday(){this.month=new n(new Date(),this.lang),this.year=new e().year}goToNextYear(){this.year+=1,this.month=new n(new Date(this.year,0),this.lang)}goToPreviousYear(){this.year-=1,this.month=new n(new Date(this.year,11),this.lang)}goToNextMonth(){return 12===this.month.number?this.goToNextYear():void(this.month=new n(new Date(this.year,this.month.number+1-1),this.lang))}goToPreviousMonth(){return 1===this.month.number?this.goToPreviousYear():void(this.month=new n(new Date(this.year,this.month.number-1-1),this.lang))}}class s extends HTMLElement{constructor(){super(),this.format="F jS (D), Y",this.position="bottom",this.visible=!1,this.date=null,this.mounted=!1,this.toggleButton=null,this.input=null,this.todayButton=null,this.calendarDropDown=null,this.calendarDateElement=null,this.calendarDaysContainer=null,this.selectedDayElement=null;const b=window.navigator.language,c=new Date(this.date??(this.getAttribute("date")||Date.now()));this.shadow=this.attachShadow({mode:"open"}),this.date=new e(c,b),this.calendar=new a(this.date.year,this.date.monthNumber,b),this.format=this.getAttribute("format")||this.format,this.position=s.position.includes(this.getAttribute("position"))?this.getAttribute("position"):this.position,this.visible=""===this.getAttribute("visible")||"true"===this.getAttribute("visible")||this.visible,this.render()}connectedCallback(){this.mounted=!0,this.toggleButton=this.shadow.querySelector(".date-toggle"),this.calendarDropDown=this.shadow.querySelector(".calendar-dropdown"),this.todayButton=this.shadow.querySelector(".today-btn");const[a,b,c]=this.calendarDropDown.querySelector(".header").children;this.calendarDateElement=b,this.calendarDaysContainer=this.calendarDropDown.querySelector(".month-days"),this.toggleButton.addEventListener("click",()=>this.toggleCalendar()),this.todayButton.addEventListener("click",()=>this.goToday()),a.addEventListener("click",()=>this.prevMonth()),c.addEventListener("click",()=>this.nextMonth()),document.addEventListener("click",a=>this.handleClickOut(a)),this.renderCalendarDays()}attributeChangedCallback(b,c,d){this.mounted&&("date"===b?(this.date=new e(new Date(d)),this.calendar.goToDate(this.date.monthNumber,this.date.year),this.renderCalendarDays(),this.updateToggleText()):"format"===b?(this.format=d,this.updateToggleText()):"visible"===b?(this.visible=["","true","false"].includes(d)?""===d||"true"===d:this.visible,this.toggleCalendar(this.visible)):"position"===b?(this.position=s.position.includes(d)?d:this.position,this.calendarDropDown.className=`calendar-dropdown ${this.visible?"visible":""} ${this.position}`):void 0)}toggleCalendar(a=null){null===a?(this.calendarDropDown.classList.toggle("visible"),this.toggleButton.classList.toggle("active")):a?(this.calendarDropDown.classList.add("visible"),this.toggleButton.classList.add("active")):(this.calendarDropDown.classList.remove("visible"),this.toggleButton.classList.remove("active")),this.visible=this.calendarDropDown.className.includes("visible"),this.visible||this.toggleButton.focus()}prevMonth(){this.calendar.goToPreviousMonth(),this.renderCalendarDays()}nextMonth(){this.calendar.goToNextMonth(),this.renderCalendarDays()}goToday(){this.calendar.goToday(),this.renderCalendarDays(),this.selectDay(this.shadow.querySelector(".today"),new e)}updateHeaderText(){this.calendarDateElement.textContent=`${this.calendar.month.name}, ${this.calendar.year}`,this.calendarDateElement.setAttribute("aria-label",`current month ${this.date.format(this.format)}`)}isSelectedDate(a){return a.date===this.date.date&&a.monthNumber===this.date.monthNumber&&a.year===this.date.year}isCurrentCalendarMonth(){return this.calendar.month.number===this.date.monthNumber&&this.calendar.year===this.date.year}selectDay(a,b){b.isEqualTo(this.date)||(this.date=b,b.monthNumber===this.calendar.month.number?(a.classList.add("selected"),this.selectedDayElement.classList.remove("selected"),this.selectedDayElement=a):(b.monthNumber<this.calendar.month.number&&this.prevMonth(),b.monthNumber>this.calendar.month.number&&this.nextMonth()),this.toggleCalendar(),this.updateToggleText())}handleClickOut(a){this.visible&&this!==a.target&&(this.toggleCalendar(!1),this.isCurrentCalendarMonth()||(this.calendar.goToDate(this.date.monthNumber,this.date.year),this.renderCalendarDays()))}getWeekDaysElementStrings(){return this.calendar.weekDays.map(a=>`<span>${a.substring(0,3)}</span>`).join("")}getMonthDaysGrid(){const b=this.calendar.month.getDay(1),c=7-this.calendar.month.getDay(this.calendar.month.numberOfDays).dayNumber,d=this.calendar.getPreviousMonth(),f=b.dayNumber-1,a=this.calendar.month.numberOfDays+f+c,g=Array.from({length:a});for(let b=f;b<a;b++)g[b]=this.calendar.month.getDay(b+1-f);for(let a=0;a<f;a++){const b=f-(a+1);g[a]=d.getDay(d.numberOfDays-b)}return g}updateToggleText(){const a=this.date.format(this.format);this.toggleButton.textContent=a}updateMonthDays(){this.calendarDaysContainer.innerHTML="",this.getMonthDaysGrid().forEach(a=>{const b=document.createElement("button");b.className="month-day",b.textContent=a.date,b.addEventListener("click",()=>this.selectDay(b,a)),b.setAttribute("aria-label",a.format(this.format)),a.monthNumber===this.calendar.month.number&&b.classList.add("current"),this.isSelectedDate(a)&&(b.classList.add("selected"),this.selectedDayElement=b),a.isEqualTo(new e)&&b.classList.add("today"),1!==a.dayNumber&&7!==a.dayNumber||b.classList.add("weekend"),this.calendarDaysContainer.appendChild(b)})}renderCalendarDays(){this.updateHeaderText(),this.updateMonthDays(),this.calendarDateElement.focus()}static get observedAttributes(){return["date","format","visible","position"]}static get position(){return["top","left","bottom","right"]}get style(){return"\n:host {\nposition: relative;\nfont-family: monospace;\n}\n.date-toggle {\ndisplay:flex;\njustify-content: center;\nalign-items: center;\npadding: 0 0 0 1rem;\nborder: none;\n-webkit-appearance:none;\n-moz-appearance:none;\nappearance:none;\nbackground: #eee;\ncolor:#333;\nborder-radius: 5px;\nborder: 2px solid #000;\nfont-weight: bold;\ncursor: pointer;\ntext-transform: capitalize;\nfont-family: 'Fira Code', monospace;\nvertical-align: middle;\n}\n.date-toggle::after {\ncontent: 'cal';\ndisplay: inline-block;\npadding: .45rem .8rem;\nmargin: 0 0 0 1rem;\nbackground: #000;\ncolor: #fff;\nborder-color: #000c;\nborder-left: 1px solid #000;\nfont-size: .7rem;\n}\n.date-toggle.active::after {\nbackground: #f55;\nborder-radius:  0 3px 3px 0;\n}\n.calendar-dropdown {\ndisplay: none;\nheight: 275px;\nposition: absolute;\ntop: 100%;\nleft:50%;\ntransform: translate(-50%, 8px);\npadding: 1rem;\nbackground: #fff;\nborder-radius: 5px;\nborder: 1px solid #eee;\ntransition: all .5s ease-in-out;\nz-index: 9999;\n}\n.calendar-dropdown.top {\ntop: auto;\nbottom: 100%;\ntransform: translate(-50%, -8px);\n}\n.calendar-dropdown.left {\ntop: 50%;\nleft: 0;\ntransform: translate(calc(-8px + -100%), -50%);\n  }\n  .calendar-dropdown.right {\ntop: 50%;\nleft: 100%;\ntransform: translate(8px, -50%);\n  }\n.today-btn {\nposition: absolute;\nbottom: .5rem;\nwidth: calc(100% - 2rem);\ntext-align: center;\ncursor: pointer;\n}\n.calendar-dropdown.visible {\ndisplay: block;\nopacity: 1;\n}\n.header {\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\nmargin: 5px 0 10px;\n}\n.header h4 {\nmargin: 0;\ntext-transform: capitalize;\nfont-size: 1rem;\nfont-weight: bold;\n}\n.header button {\npadding: 0;\nborder: 8px solid transparent;\nwidth: 0;\nheight: 0;\nborder-radius: 2px;\nborder-top-color: #555;\ntransform:rotate(90deg);\ncursor: pointer;\nbackground: none;\nposition: relative;\n}\n.header button::after {\ncontent: '';\ndisplay: block;\nwidth:25px;\nheight:25px;\nposition: absolute;\nleft:50%;\ntop:50%;\ntransform: translate(-50%, -50%);\n// background: red;\n}\n.header button:last-of-type {\ntransform:rotate(-90deg);\n}\n.week-days {\ndisplay: grid;\ngrid-template-columns: repeat(7, 1fr);\nmargin-bottom: 5px;\n-webkit-user-select: none;\ncursor: default;\n}\n.week-days span{\ndisplay: flex;\njustify-content: center;\nfont-size: 10px;\ntext-transform: capitalize;\n}\n.week-days span:first-child {\ncolor: red;\n}\n.week-days span:last-child {\ncolor: red;\n}\n.month-days {\ndisplay: grid;\ngrid-template-columns: repeat(7, 1fr);\ngrid-gap: 5px;\n}\n.month-day {\nborder: none;\nbackground: #eee;\nopacity: 0.3;\nfont-family: 'Fira Code', monospace;\n// font-size: .55rem;\npadding: 5px 6px;\ndisplay: flex;\njustify-content: center;\nalign-items: center;\nborder-radius: 5px;\ncursor:pointer;\n}\n.month-day.current {\ndisplay: flex;\nopacity: 1;\nborder: 1px solid #0002;\n}\n.month-day.weekend {\ncolor: #f55;\n}\n.month-day.today {\nbackground: #f55;\nborder: 1px solid #000;\ncolor: #000;\n}\n.month-day.selected {\nbackground: #9f9;\nborder-color: #0008;\ncolor: #000;\n}\n.month-day:hover {\nbackground: #000a;\ncolor: #fff;\n}\n"}render(){const a=`${this.calendar.month.name}, ${this.calendar.year}`,b=this.date.format(this.format);this.shadow.innerHTML=`\n<style>${this.style}</style>\n<div class="date-p">\n<button type="button" class="date-toggle">${b}</button>\n</div>\n<div class="calendar-dropdown ${this.visible?"visible":""} ${this.position}">\n<div class="header">\n<button type="button" class="prev-month" aria-label="previous month"></button>\n<h4 tabindex="0" aria-label="current month ${a}">\n${a}\n</h4>\n<button type="button" class="prev-month" aria-label="next month"></button>\n</div>\n<div class="week-days">${this.getWeekDaysElementStrings()}</div>\n<div class="month-days"></div>\n<div class="today-btn">Today</div>\n</div>\n`}}customElements.define("date-picker",s);